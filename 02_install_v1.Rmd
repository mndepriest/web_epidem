 
 
---
title: "Before Starting"
output: 
  html_document:
    code_folding: show
    toc: true
    toc_float:
      toc_depth: 3
      collapsed: false
      smooth_scroll: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, eval = FALSE)
```
## Installation

To securely download **R**:

-   Go to <https://cran.r-project.org/>

-   Under 'Download and Install R', select the download option appropriate for your operating system (OS)


-   Download the file appropriate for your OS:

    -   For Windows users, click 'Base'. This will begin downloading the installer for the latest R version for your OS.

    -   For Mac users, select the latest R version`.pkg` file appropriate for your OS version. The installer for R will begin downloading  
   

-   Follow the instructions of the installer

To download **RStudio**:

-   Go to RStudio for desktop <https://www.rstudio.com/products/rstudio/download/#download>

-   Select the install file appropriate for your OS and follow the installer instructions

For **Windows -** Install **Rtools** (an R tool needed to build R packages with C/C++/Fortran code from source) by visiting this page: <https://cran.r-project.org/bin/windows/Rtools/rtools40.html>

## Upgrade/Update

At some point, running old versions of software adds unnecessary difficulty. R had a major version change in April 2020, with the release of 4.0.0. It is a good idea to be on the current major version, meaning 4.0.0 or higher as of 2023. Each major version is followed by several years of smaller releases (minor and patch releases) that are indicated by the numbers following '4.' (ex. 4.2.2, 4.2.1, etc.,). You can be more relaxed about upgrading minor versions (such as upgrading between 4.2.1 and 4.2.2), but you still want to stay reasonably current. A consequence of running 'old' versions of R are that functions may not operate correctly, creating unnecessary errors. 

You can check your current R version by running the code below in your RStudio console pane:

```{r}
# Here we use function 'R.version.string()' to receive information about the R version we are currently using: 
R.version.string
#> [1] "R version 4.1.2 (2021-11-01)"
```

Then go to [\<https://cran.r-project.org/\>](https://cran.r-project.org/){.uri} and check that you have the same major (4.#.#) version of R. 

Warning: Running a different major version of R (such as R 3.6.3) will almost definitely cause *significant* difficulties. It is also deeply beneficial to use an R version with the second digit matching as well (ie., R 4.2.2 vs. 4.1.2). Upgrading R when the third digit is different (indicating a minor upgrade) can be considered optional (i.e., upgrading between R 4.2.2 and 4.2.1). 

**Updating RStudio** is easy. Just go to `Help` in the toolbar at the top left corner and select 'Check for Updates` to receive instructions for installing the latest version.

## Libraries/Packages

### CRAN Libraries/Packages

#### Installation

Several package libraries will be necessary to reproduce the provided R materials. Initially, we will introduce these package with a short explanation of these purpose. You can refer to different packages within the RStudio environment by their name, expressed as a character vector (within quotation "" marks), as shown below. 

CRAN packages can be installed using their name as a character vector as shown below: 

```{r , message=FALSE, warning=FALSE}

# Here we create a list of desired packages. We use package names as character vectors to 'call' them within the R environment. 
list.of.packages <-
  c("devtools", # A package for managing (installing, loading, checking) other packages 
    "conflicted", # A package for managing 'conflicts' within packages. A common conflict is when two packages have functions with the same name but a different purpose
    "here", # A package that improves reproducibility across different operating systems/users by defining the 'work environment' 
    
    # There are also packages for managing data files:
    "readr", # A package for handling common data files like `.csv`
    "readxl", # A package for handling Excel files like `.xlsx`
    
    # Here are packages that help manipulate (or 'wrangle') data structures:
    "dplyr", # For data manipulation, such as inspecting individual variables
    "tidyr", # For 'tidying' data, such as converting the data's structure or making it more readable
    "reshape2", # Another package with additional tools for manipulating your data
    "purrr", # A package that provides tools for working with functions and vectors
    
    # Packages for plotting: 
    "ggplot2", # A popular R package with tools for creating high-level plots
    "plotly", # Another advanced visualization package
    "ggsci", # A package for applying color palettes to visuals
    "ggthemes", # A package that adds more options for visual design
    "patchwork", # A package that allows users to combine plots
    "stringr", # A package that can improve the readability of visuals by providing tools for string and factor manipulation (i.e., 'trt' can become 'treatment' for the purposes of creating an informative figure)

    # Packages for analysis & modelling:
    "minpack.lm", # For fitting non-linear models
    "deSolve", # For solving initial value problems of differential equations
    "psych", # A package with tools for evaluating psychiatric data. We use this as an educational example
    "car", # For more analytical/modelling functions and tools
    "emmeans", # For modelling functions
    "agricolae", # A source of diverse functions and data sets in agronomy 
    
    # Packages for visualizing outputs of statistical analysis: 
    "rcompanion", # A useful tool for summarizing model outputs and other modeling tasks
    "ggResidpanel", # For creating and managing diagnostic plots

    # Packages for parallel computation: 
    # (using multiple cores to execute R code)
    "pbapply", # A package that visualizes computational progress
    "parallel", # A package for managing concurrent computational processes 

    # Packages for text formatting/report creation:
    "rmarkdown", # A package for creating and formatting files (such as htmls) in R
    "gt", # A package for customizing html table view
    "kableExtra", # Another package for html table customization
    
    # Advanced visualizations/App building:
    "shiny", # Package for visualization 
    "shinyscreenshot", # For capturing screenshots
    "shinydashboard" # Additional shiny tools
  )
```

```{r libs, message=FALSE, warning=FALSE}
# Packages CAN be installed individually, but it requires a lot more text and copy/paste:
install.package("devtools")
install.package("conflicted")
install.package("here")
# and so on...

# Creating an object containing all of your desired package names as character vectors (ex. "packagename") makes our task a lot easier. 

```

We can install the packages listed in `list.of.packages` by passing the object to the installation function `install.packages()`. Things should go smoothly if your R version is up to date, but there can be occasional problems. Below, we have shown how to deal with several of the more commons errors that can occur during package installation. 

```{r}
# We run the function `install.packages`, provided with our list of desired packages: 
install.packages(list.of.packages)

# R may respond with a message telling you that R will need to be restarted.

```

If there are problems installing some package, sometimes directing R to download packages from different sources (repositories) can help the issue. CRAN has [multiple repositories](https://cran.r-project.org/mirrors.html) that get different amounts of traffic at different times. Repositories can also slow down because of failures or maintenance. You can direct R to a another, less busy repository with the `repos` argument. 

```{r}
# For example, we can run this line where we direct R to install package ROCR from a different CRAN repository. Just un-comment the command below (remove the #).

#install.packages("ROCR", repos = c(CRAN="https://cran.r-project.org/")) 

```

Assuming you have listed all of your desired packages in object `list.of.packages`, you can check that all packages are installed with the following command: 

```{r}
list.of.packages %in% installed.packages()
```

If you see some `FALSE` values there, then you can check which packages are missing with the following line of code. 

```{r}
list.of.packages[!(list.of.packages %in% installed.packages()[, "Package"])]

```

#### Updating

##### Windows

It's good to update your installed packages often. You might need to restart R during this process as well. With Windows OS, this is straightforward. 

```{r}
update.packages(ask = FALSE, checkBuilt = TRUE)
```

Additionally, R will often alert you to package updates with feedback in the RStudio console. 

##### Other OS

Updating packages with non-Windows OS can be more complicated. A lot of packages that currently exist were built under the old major R version (R 3.0.0 through 3.6.9). If you have any packages that were downloaded when you were using any R version below R 4.0.0, it is safer to re-install these packages. 

You can achieve this with the following commands. However, this will not work for packages installed with `devtools::install_github()`. 

```{r}
# Create data frame 'packs', which contains the name of all currently installed packages:
packs = as.data.frame(installed.packages(.libPaths()[1]), stringsAsFactors = F)

## Now re-install these packages using install.packages():
install.packages(packs$Package)
```

### Non-CRAN Packages

There are packages which are not published in public repositories. These are installed directly from some public repository, such as GitHub.

```{r}
.rs.restartR()
Sys.sleep(2)
remotes::install_github("bbc/bbplot",dependencies = TRUE)
```

If you run into problems... Installing packages that are not on CRAN can be a pain, so there are a few general notes on what to do.\
If you are Windows user it is recommended that you make sure you have the [Rtools](https://cran.r-project.org/bin/windows/Rtools/) installed. If you get an error like this while updating your packages:

```{r error_noncran_pck, eval=FALSE}
Error: (converted from warning) cannot remove prior installation of package ‘name_of_the_package’
```

You might need to update some packages manually to match the *source* version. So, just replace the `name_of_the_package` to match the name of the package you are missing/need to update.

```{r}
install.packages("name of the package", type = "source")
```

After that, try run the code snippet for the installation of package from the beginning of this subsection.

From here, you can try the trouble-shooting methods we discussed above. If these methods don't work, you can often find package-specific installation instructions with the package's documentation online. For instance, entering 'r install KrigR' in a browser search bar will bring you to the GitHub repository where non-CRAN package 'KrigR' is hosted. Reading the README.md file shows specific installation instructions. From there, you can copy/paste the installation instructions to your RStudio console.

For instance, running these lines in your RStudio console will install and load package KrigR:
```{r}
# Un-comment the next three lines (remove the #) to install KrigR
# Sys.setenv(R_REMOTES_NO_ERRORS_FROM_WARNINGS="true")
# devtools::install_github("https://github.com/ErikKusch/KrigR")
# library(KrigR)
```

### Install our package with apps

We will need certain packages for this tutorial. Run following lines of code to install them:

```{r eval = FALSE}
if(!"devtools" %in% installed.packages ()) install.packages("devtools")
devtools::install_github("mladencucak/AppTest")
AppTest::GrowModAPP()
AppTest::HLIRApp()
```
